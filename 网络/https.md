### HTTPS

#### 简介

`HTTPS`是基于`HTTP`基础上建立`SSL`加密层的通信协议，并对传输数据进行加密，是`HTTP`协议的安全版。一般来说，`HTTP`直接与`TCP`通信，使用`SSL`后，`HTTP`与`SSL`先通信，再由`SSL`与`TCP`通信。



#### HTTP与HTTPS的区别

`HTTP`是明文传输的协议，有两个缺点：

1. 无法验证数据的完整性
2. 无法验证通信方的身份

相较于`HTTP`，`HTTPS`多了如下几个优势：

1. 数据隐私性：内容对称加密，每个连接生成一个唯一的加密密钥。
2. 数据完整性：内容传输经过完整性校验
3. 身份认证，第三方无法伪造服务端（客户端）身份

区别：

- `HTTPS`标准端口443，`HTTP`标准端口80;
- `HTTPS`需要用到`SSL`证书



#### HTTPS解决的问题

##### 数据加密

数据加密方式有两种，分别是：`对称加密`，`非对称加密`

- 对称加密，客户端和服务端都使用同样的密钥对消息进行加密，解密。缺点也很明显，密钥一旦被第三方获取到，整个数据通信就变成明文传输了。
- 非对称加密，服务端存在一个公钥和一个私钥，私钥加密的内容只有公钥能解开，公钥加密的内容只有私钥能打开。将公钥下发给客户端，由客户端使用公钥加密数据，服务端使用私钥解密数据。非对称加密的问题在于公钥是公开的，所以私钥加密的数据有可能被暴露。
- 对称加密+非对称加密。服务端存在一个公钥和一个私钥，客户端生成一个唯一的密钥，使用服务端的公钥传输至服务端，双方约定好使用客户端生成的密钥进行通信。



##### 通信身份验证（数字证书）

- 服务器的运营人员向第三方机构CA提交证书审核
- CA通过线上，线下多种手段验证信息真实性
- 审核通过后，CA会向申请者签发认证文件证书，包含：公钥，数字签名等
- 客户端向服务端发送请求时，服务端返回证书文件
- 客户端验证证书的域名信息等，获取公钥。



#### HTTPS工作流程

1. 客户端发起一个请求
2. 服务端向客户端返回证书文件
3. 客户端验证证书文件，获取公钥
4. 客户端使用伪随机数生成器生成加密所用的对称密钥，然后用证书公钥加密该对称密钥，发送给服务端
5. 服务端使用自己的私钥解密这个消息，得到对称密钥。客户端与服务端，双方都得到了相同的对称密钥。
6. 服务端使用对称密钥加密数据，发送到客户端
7. 客户端使用对称密钥解密数据，得到明文数据
8. 服务端，客户端使用对称密钥进行通信



